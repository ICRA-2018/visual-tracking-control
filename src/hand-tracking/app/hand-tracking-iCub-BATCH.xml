<?xml version="1.0" encoding="ISO-8859-1"?>
<?xml-stylesheet type="text/xsl" href="yarpmanifest.xsl"?>
<application>

  <!-- GENERIC INFORMATION -->
  <name>hand-tracking-BATCH</name>
  <description>Offline visual hand tracking for the iCub robot using a 3D model-aided particle filter</description>
  <version>0.5.0.0</version>

  <authors>
    <author email="claudio.fantacci@iit.it">Claudio Fantacci</author>
  </authors>


  <!-- REQUIRED MODULES -->
  <module>
    <name>hand-tracking</name>
    <parameters>--robot icub --play --cam left</parameters>
    <node>localhost</node>
  </module>

  <module>
    <name>hand-tracking</name>
    <parameters>--robot icub --play --cam right</parameters>
    <node>localhost</node>
  </module>

  <module>
    <name>yarpdataplayer</name>
    <parameters>--withExtraTimeCol 2</parameters>
    <node>localhost</node>
  </module>


  <!-- REQUIRED CONNECTIONS -->
  <!-- Particle filter connections -->
  <connection>
    <from>/icub/camcalib/left/out</from>
    <to>/handTracking/VisualSIS/left/img:i</to>
    <protocol>mcast</protocol>
  </connection>

  <connection>
    <from>/icub/camcalib/right/out</from>
    <to>/handTracking/VisualSIS/right/img:i</to>
    <protocol>mcast</protocol>
  </connection>

  <!-- Initialitazion connections -->
  <connection>
    <from>/icub/torso/state:o</from>
    <to>/handTracking/InitiCubArm/left/torso:i</to>
    <protocol>tcp</protocol>
  </connection>

  <connection>
    <from>/icub/right_arm/state:o</from>
    <to>/handTracking/InitiCubArm/left/right_arm:i</to>
    <protocol>tcp</protocol>
  </connection>

  <connection>
    <from>/icub/torso/state:o</from>
    <to>/handTracking/InitiCubArm/right/torso:i</to>
    <protocol>tcp</protocol>
  </connection>

  <connection>
    <from>/icub/right_arm/state:o</from>
    <to>/handTracking/InitiCubArm/right/right_arm:i</to>
    <protocol>tcp</protocol>
  </connection>

  <!-- Motion model connections -->
  <connection>
    <from>/icub/torso/state:o</from>
    <to>/handTracking/PlayiCubFwdKinModel/left/torso:i</to>
    <protocol>tcp</protocol>
  </connection>

  <connection>
    <from>/icub/right_arm/state:o</from>
    <to>/handTracking/PlayiCubFwdKinModel/left/right_arm:i</to>
    <protocol>tcp</protocol>
  </connection>

  <!-- VisualProprioception connections -->
  <connection>
    <from>/icub/head/state:o</from>
    <to>/handTracking/VisualProprioception/iCubCamera/left/head:i</to>
    <protocol>tcp</protocol>
  </connection>

  <connection>
    <from>/icub/head/state:o</from>
    <to>/handTracking/VisualProprioception/iCubCamera/right/head:i</to>
    <protocol>tcp</protocol>
  </connection>

  <connection>
    <from>/icub/torso/state:o</from>
    <to>/handTracking/VisualProprioception/iCubCamera/left/torso:i</to>
    <protocol>tcp</protocol>
  </connection>

  <connection>
    <from>/icub/torso/state:o</from>
    <to>/handTracking/VisualProprioception/iCubCamera/right/torso:i</to>
    <protocol>tcp</protocol>
  </connection>

  <connection>
    <from>/icub/right_arm/state:o</from>
    <to>/handTracking/VisualProprioception/iCubArmModel/left/right_arm:i</to>
    <protocol>tcp</protocol>
  </connection>

  <connection>
    <from>/icub/right_arm/state:o</from>
    <to>/handTracking/VisualProprioception/iCubArmModel/right/right_arm:i</to>
    <protocol>tcp</protocol>
  </connection>

  <connection>
    <from>/icub/torso/state:o</from>
    <to>/handTracking/VisualProprioception/iCubArmModel/left/torso:i</to>
    <protocol>tcp</protocol>
  </connection>

  <connection>
    <from>/icub/torso/state:o</from>
    <to>/handTracking/VisualProprioception/iCubArmModel/right/torso:i</to>
    <protocol>tcp</protocol>
  </connection>

  <!-- ResamplingWithPrior connections -->
  <connection>
    <from>/icub/torso/state:o</from>
    <to>/handTracking/ResamplingWithPrior/InitiCubArm/left/torso:i</to>
    <protocol>tcp</protocol>
  </connection>

  <connection>
    <from>/icub/right_arm/state:o</from>
    <to>/handTracking/ResamplingWithPrior/InitiCubArm/left/right_arm:i</to>
    <protocol>tcp</protocol>
  </connection>

  <connection>
    <from>/icub/torso/state:o</from>
    <to>/handTracking/ResamplingWithPrior/InitiCubArm/right/torso:i</to>
    <protocol>tcp</protocol>
  </connection>

  <connection>
    <from>/icub/right_arm/state:o</from>
    <to>/handTracking/ResamplingWithPrior/InitiCubArm/right/right_arm:i</to>
    <protocol>tcp</protocol>
  </connection>


  <!-- Visualization via iCubProprioception -->
  <connection>
    <from>/handTracking/VisualSIS/left/estimates:o</from>
    <to>/iCubProprioception/BatchCADSuperimposer/cam/left/hand/right_pose:i</to>
    <protocol>tcp</protocol>
  </connection>

  <connection>
    <from>/handTracking/VisualSIS/right/estimates:o</from>
    <to>/iCubProprioception/BatchCADSuperimposer/cam/right/hand/right_pose:i</to>
    <protocol>tcp</protocol>
  </connection>

</application>
